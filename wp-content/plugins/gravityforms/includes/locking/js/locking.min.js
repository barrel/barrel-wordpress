!function(a,b){function c(){b("#gform-lock-request-status").html(h.noResponse),b("#gform-lock-request-button").attr("disabled",!1).text(h.requestAgain),m=!1,l=!0,k=!1,wp.heartbeat.interval(30)}function d(){b("#gform-lock-request-button").click(function(){var a=b(this);a.text("Request sent"),a.attr("disabled",!0),b("#gform-lock-request-status").html(""),l=!1,m=!0,wp.heartbeat.interval(5),k=setTimeout(c,12e4),b.getJSON(ajaxurl,{action:"gf_lock_request_"+g,object_id:f}).done(function(a){b("#gform-lock-request-status").html(a.html)}).fail(function(a,c,d){var e=c+", "+d;b("#gform-lock-request-status").html(h.requestError+": "+e)})}),b("#gform-reject-lock-request-button").click(function(){b.getJSON(ajaxurl,{action:"gf_reject_lock_request_"+g,object_id:f,object_type:g}).done(function(a){b("#gform-lock-dialog").hide()}).fail(function(a,c,d){var e=c+", "+d;b("#gform-lock-request-status").html(h.requestError+": "+e),b("#gform-lock-dialog").hide()})})}function e(){wp.heartbeat.interval(30),b("#wpfooter").append(j);var a="gform-refresh-lock-"+g,c="gform-request-lock-"+g;b(document).on("heartbeat-send."+a,function(c,d){var e={};f&&b("#gform-lock-dialog").length&&0!=i&&(e.objectID=f,d[a]=e)}),b(document).on("heartbeat-send."+c,function(a,b){var d={};if(!m)return b;d.objectID=f,b[c]=d}),b(document).on("heartbeat-tick."+a,function(c,d){var e,f,g,h;if(d[a]&&(e=d[a],e.lock_error||e.lock_request)){if(h=e.lock_error?e.lock_error:e.lock_request,f=b("#gform-lock-dialog"),!f.length)return;f.is(":visible")?e.lock_error?b("#gform-reject-lock-request-button").is(":visible")&&(e.lock_error.avatar_src&&(g=b('<img class="avatar avatar-64 photo" width="64" height="64" />').attr("src",e.lock_error.avatar_src.replace(/&amp;/g,"&")),f.find("div.gform-locked-avatar").empty().append(g)),b("#gform-reject-lock-request-button").hide(),f.show().find(".currently-editing").text(e.lock_error.text)):e.lock_request&&b("#gform-lock-request-status").html(e.lock_request.text):(h.avatar_src&&(g=b('<img class="avatar avatar-64 photo" width="64" height="64" />').attr("src",h.avatar_src.replace(/&amp;/g,"&")),f.find("div.gform-locked-avatar").empty().append(g)),f.show().find(".currently-editing").text(h.text),e.lock_request?b("#gform-reject-lock-request-button").show():b("#gform-reject-lock-request-button").hide(),f.find(".wp-tab-first").focus())}}),b(document).on("heartbeat-tick."+c,function(a,d){var e,f,g;if(d[c]&&(e=d[c],e.status)){if(g=e.status,f=b("#gform-lock-dialog"),!f.length)return;switch("pending"!=g&&(clearTimeout(k),k=!1,m=!1),g){case"granted":b("#gform-lock-request-status").html(h.gainedControl),b("#gform-take-over-button").show(),b("#gform-lock-request-button").hide(),i=!0;break;case"deleted":b("#gform-lock-request-button").text(h.requestAgain).attr("disabled",!1),b("#gform-lock-request-status").html(h.rejected);break;case"pending":b("#gform-lock-request-status").html(h.pending)}}})}b(document).ready(function(){a.init()});var f,g,h,i,j,k,l,m=!1;a.init=function(){i=gflockingVars.hasLock,f=gflockingVars.objectID,g=gflockingVars.objectType,j=gflockingVars.lockUI,h=gflockingVars.strings,e(),d()}}(window.gflocking=window.gflocking||{},jQuery);